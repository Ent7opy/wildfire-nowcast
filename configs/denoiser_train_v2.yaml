# Denoiser v2 Training Config – Ground Truth Labels
#
# Uses labels from label_v2 (NIFC fire perimeter cross-reference) instead of
# heuristic-only labels.  The model architecture and features are identical to
# v1; only the label source and snapshot differ.
#
# Workflow:
#   1. python -m ingest.nifc_perimeters_ingest --year 2024 --year 2025
#   2. python -m ml.denoiser.label_v2 --bbox -125 24 -66 50 --start 2024-01-01 --end 2025-01-01
#   3. python -m ml.denoiser.export_snapshot --bbox -125 24 -66 50 --start 2024-01-01 --end 2025-01-01 --version v2.0.0 --out data/denoiser/snapshots
#   4. Update snapshot_path below to the exported run directory.
#   5. python -m ml.train_denoiser --config configs/denoiser_train_v2.yaml

seed: 42
model_output_root: "models/denoiser_v2"

# Input data – update after running export_snapshot with v2 labels
snapshot_path: "data/denoiser/snapshots/run_YYYYMMDD_HHMMSS"

# Feature selection (same as v1)
features:
  - "confidence_norm"
  - "frp"
  - "brightness"
  - "bright_t31"
  - "brightness_minus_t31"
  - "scan"
  - "track"
  - "sin_hour"
  - "cos_hour"
  - "sin_doy"
  - "cos_doy"
  - "n_2km_6h"
  - "n_2km_24h"
  - "n_5km_24h"
  - "n_same_cell_24h"
  - "n_same_cell_7d"
  - "dist_nn_24h_km"
  - "seen_same_cell_past_3d"
  - "days_with_detection_past_30d_in_cell"
  - "elevation_m"
  - "slope_deg"
  - "aspect_sin"
  - "aspect_cos"

# Split policy
split_percentile: 0.8
gap_hours: 0
split_strategy: "time"
fallback_split_strategy: "stratified_random"
eval_size: 0.2

# Model parameters (same architecture; may tune once we have more data)
model_params:
  max_iter: 200          # increased from 100 — more data can support more boosting rounds
  learning_rate: 0.1
  max_depth: 5
  l2_regularization: 0.01
  random_state: 42

# Imbalance handling (should be less necessary with balanced ground-truth labels)
handle_imbalance: true

# Evaluation thresholds
eval_thresholds: [0.2, 0.3, 0.5, 0.7, 0.8]

# Baselines
baseline_models:
  - name: "confidence_norm"
    column: "confidence_norm"
    normalize: true
  - name: "frp"
    column: "frp"
    normalize: true
