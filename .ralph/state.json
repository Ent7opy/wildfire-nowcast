{
  "version": 1,
  "created_at": "2026-01-19T17:47:54Z",
  "goal_summary": "Improve wildfire detection quality by replacing naive FIRMS confidence filtering with a composite Fire Likelihood Score that combines FIRMS confidence (weak prior), persistence filtering, land-cover plausibility, weather plausibility, and industrial false-source masking. Fix UI bugs (tooltip, details panel, coordinate extraction) and update UI to reflect new likelihood semantics.",
  "tasks": [
    {
      "id": "WN-FIRE-004",
      "title": "Integrate weather plausibility checks",
      "priority": "P1",
      "depends_on": [],
      "description": "Add `weather_score` column via same migration. In api/fires/scoring.py add compute_weather_scores(detections, weather_runs) that queries weather data (RH, precipitation, wind) for each detection location+time. Rules: RH>70%: score=0.3, recent precip (48h, >10mm): score=0.4, low RH + moderate wind: score=1.0. Reuse existing weather ingestion from api/routes/forecast.py patterns.",
      "files_likely": [
        "api/fires/scoring.py",
        "api/fires/repo.py"
      ],
      "acceptance": [
        "compute_weather_scores() queries weather data spatially and temporally",
        "High RH penalizes score",
        "Recent precipitation penalizes score",
        "Low RH + wind boosts score"
      ],
      "verification": [
        "Would run: cd api && uv run pytest tests/test_fire_weather_scoring.py -v"
      ],
      "status": "completed",
      "commits": [
        "3e83477",
        "858da0c",
        "9419f7b"
      ],
      "notes": [
        "worker: Integrated weather plausibility checks into fire detection scoring. Added compute_weather_plausibility_scores() function that queries weather data (RH, precipitation, wind) and computes plausibility scores based on meteorological conditions. Created database migration for weather_score column and batch update function.",
        "Successfully implemented and tested. All 7 weather plausibility tests pass."
      ],
      "review_cycles": 0,
      "unblock_attempts": 0
    },
    {
      "id": "WN-FIRE-006",
      "title": "Compute composite Fire Likelihood Score",
      "priority": "P0",
      "depends_on": [
        "WN-FIRE-001",
        "WN-FIRE-002",
        "WN-FIRE-003",
        "WN-FIRE-004",
        "WN-FIRE-005"
      ],
      "description": "Add `fire_likelihood` float column via same migration. In api/fires/scoring.py create compute_fire_likelihood(detection) that combines: confidence_score*0.2 + persistence_score*0.3 + landcover_score*0.2 + weather_score*0.2 + multi_sensor_bonus*0.1. Update api/fires/repo.py to filter by fire_likelihood instead of raw confidence. Default threshold: ≥0.3 (uncertain), ≥0.6 (likely real).",
      "files_likely": [
        "api/fires/scoring.py",
        "api/fires/repo.py",
        "api/routes/fires.py"
      ],
      "acceptance": [
        "fire_likelihood column exists and populated",
        "API filters by fire_likelihood with default min_likelihood=0.3",
        "Weights sum to 1.0",
        "Global map shows plausible fire distribution (no continuous belts)"
      ],
      "verification": [
        "Would run: cd api && uv run pytest tests/test_fire_composite_likelihood.py -v",
        "Would run: psql -c 'SELECT MIN(fire_likelihood), MAX(fire_likelihood), AVG(fire_likelihood) FROM fire_detections WHERE fire_likelihood IS NOT NULL;'",
        "Would run: make lint"
      ],
      "status": "todo",
      "commits": [],
      "notes": [],
      "review_cycles": 0,
      "unblock_attempts": 0
    },
    {
      "id": "WN-FIRE-007",
      "title": "Update UI to reflect fire likelihood semantics",
      "priority": "P0",
      "depends_on": [
        "WN-FIRE-006"
      ],
      "description": "In ui/components/sidebar.py, rename 'Minimum confidence' slider to 'Fire likelihood threshold'. Change slider range to 0.0-1.0 (default 0.3). Add st.info tooltip: 'Composite score combining FIRMS confidence, persistence, land-cover, weather, and false-source filtering.' Update API call in ui/services/api.py to use min_likelihood param instead of min_confidence.",
      "files_likely": [
        "ui/components/sidebar.py",
        "ui/services/api.py"
      ],
      "acceptance": [
        "Slider labeled 'Fire likelihood threshold'",
        "Tooltip explains composite score",
        "API calls use min_likelihood parameter",
        "No mention of 'confidence' implying real fire probability"
      ],
      "verification": [
        "Would run: make dev-ui (manual inspection)",
        "Would run: cd ui && uv run pytest tests/test_app_imports.py"
      ],
      "status": "todo",
      "commits": [],
      "notes": [],
      "review_cycles": 0,
      "unblock_attempts": 0
    }
  ]
}
